{"common":{"fileName":"移动博客日志分析"},"pipelist":{"博文页页面加载数据":{"type":"pipe","name":"博文页页面加载数据","source":{"result":"C:\\fakepath\\result.dat"},"state":"success","ready":true,"filter":"return result.filter(function(str){\n  return (/type=38_01_40/).test(str);\n}).map(function(str){\n  str = str.replace('type=38_01_40_', '');\n  var obj = {};\n  var arr = str.split('_');\n  var uid;\n  if(arr[0] !== 'pageid'){\n    uid = arr.shift();\n  }\n  var key = '';\n  for(i = 0; i < arr.length; i++){\n    if(i % 2 === 0){\n      key = arr[i];\n    }else{\n      obj[key] = arr[i];\n    }\n  }\n  return obj;\n}).filter(function(obj){\n  return (\n    obj.pageid === 'article' &&\n    obj. ptype === 'pageload'\n  );\n});\n"},"博文页时间线数据":{"type":"pipe","name":"博文页时间线数据","source":{"data":"博文页页面加载数据"},"state":"success","ready":true,"filter":"return data.map(function(item){\n  delete item.pageid;\n  delete item.ptype;\n  delete item.route;\n  return item;\n});"},"博文页时间线平均数据":{"type":"pipe","name":"博文页时间线平均数据","source":{"data":"博文页时间线数据"},"state":"success","ready":true,"filter":"var all = {};\ndata.forEach(function(item){\n  Object.keys(item).forEach(function(name){\n    if(!all[name]){\n      all[name] = 0;\n    }\n    all[name] += parseInt(item[name], 10);\n  });\n});\nvar output = [];\nObject.keys(all).forEach(function(name){\n  output.push({\n    type : name,\n    time : (all[name] / data.length).toFixed(2)\n  });\n});\nreturn output;"},"单位时间阶段内pagelets报告次数":{"type":"pipe","name":"单位时间阶段内pagelets报告次数","source":{"data":"博文页时间线数据"},"state":"success","ready":true,"filter":"var conf = {};\n//计算时间间隔\nconf.timeSpace = 100;\n//过滤少于50次报告的数据\nconf.datalimit = 50;\n\nvar hashDivision = data.reduce(function(obj, item){\n  var time = Math.round(item.pagelets / conf.timeSpace);\n  if(!time || time < 0){return obj;}\n  if(!obj[time]){\n    obj[time] = [];\n  }\n  obj[time].push(item);\n  return obj;\n}, {});\n\nvar arrDivision = [];\nObject.keys(hashDivision).forEach(function(key){\n  if(Array.isArray(hashDivision[key])){\n    var length = hashDivision[key].length;\n    if(length >= conf.datalimit){\n      arrDivision.push({\n        time : parseInt(key, 10),\n        length : hashDivision[key].length\n      });\n    }\n  }\n});\n\nvar hashNew = {};\nvar timeMax = 0;\narrDivision.forEach(function(item){\n  timeMax = Math.max(timeMax, item.time);\n  hashNew[item.time] = true;\n});\n\nfor(var index = 0; index < timeMax; index++){\n  if(!hashNew[index]){\n    if(hashDivision[index]){\n      arrDivision.push({\n        time : index,\n        length : hashDivision[index].length\n      });\n    }else{\n      arrDivision.push({\n        time : index,\n        length : 0\n      });\n    }\n  }\n}\n\narrDivision.sort(function(item1, item2){\n  return item1.time - item2.time;\n}).map(function(item){\n  item.time = item.time * 100;\n  return item;\n});\n\n\nreturn arrDivision;"},"过滤极值之后的时间线数据":{"type":"pipe","name":"过滤极值之后的时间线数据","source":{"data":"博文页时间线数据"},"state":"success","ready":true,"filter":"var conf = {};\n//计算时间间隔\nconf.timeSpace = 100;\n//过滤少于50次报告的数据\nconf.datalimit = 50;\n\nvar hashDivision = data.reduce(function(obj, item){\n  var time = Math.round(item.pagelets / conf.timeSpace);\n  if(!time || time < 0){return obj;}\n  if(!obj[time]){\n    obj[time] = [];\n  }\n  obj[time].push(item);\n  return obj;\n}, {});\n\nvar filteredData = [];\nObject.keys(hashDivision).forEach(function(key){\n  if(Array.isArray(hashDivision[key])){\n    var length = hashDivision[key].length;\n    if(length >= conf.datalimit){\n      filteredData = filteredData.concat(hashDivision[key]);\n    }\n  }\n});\n\nreturn filteredData;"},"过滤极值之后的时间线平均数据":{"type":"pipe","name":"过滤极值之后的时间线平均数据","source":{"data":"过滤极值之后的时间线数据"},"state":"success","ready":true,"filter":"var all = {};\ndata.forEach(function(item){\n  Object.keys(item).forEach(function(name){\n    if(!all[name]){\n      all[name] = 0;\n    }\n    all[name] += parseInt(item[name], 10);\n  });\n});\nvar output = [];\nObject.keys(all).forEach(function(name){\n  output.push({\n    type : name,\n    time : (all[name] / data.length).toFixed(2)\n  });\n});\nreturn output;"},"博文页渲染各个阶段消耗时间":{"type":"pipe","name":"博文页渲染各个阶段消耗时间","source":{"rs":"过滤极值之后的时间线平均数据"},"state":"success","ready":true,"filter":"return rs.sort(function(item1, item2){\n  return item1.time - item2.time;\n}).map(function(item, index){\n  var prevItem = rs[index - 1];\n  if(prevItem){\n    item.interval = (item.time - prevItem.time).toFixed(2);\n  }else{\n    item.interval = item.time;\n  }\n  return item;\n});"}},"diagramlist":{"单位时间阶段内pagelets报告次数":{"type":"diagram","name":"单位时间阶段内pagelets报告次数","source":{"data":"单位时间阶段内pagelets报告次数"},"state":"success","ready":true,"chart":{"type":"echarts/bar"},"filter":"return data;"},"博文页渲染各个阶段消耗时间":{"type":"diagram","name":"博文页渲染各个阶段消耗时间","source":{"rs":"博文页渲染各个阶段消耗时间"},"state":"success","ready":true,"chart":{"width":"600","dataName":"time","value":"interval","categoryLabelInterval":"0","type":"echarts/bar"},"filter":"return rs;"},"博文页渲染各个阶段消耗时间-饼图":{"type":"diagram","name":"博文页渲染各个阶段消耗时间-饼图","source":{"rs":"博文页渲染各个阶段消耗时间"},"state":"success","ready":true,"chart":{"width":"600","dataName":"interval","seriesCenterX":"50","value":"interval","type":"echarts/pie"},"filter":"return rs;"},"博文页渲染各个阶段消耗时间 - 自定义图表":{"type":"diagram","name":"博文页渲染各个阶段消耗时间 - 自定义图表","source":{"rs":"博文页渲染各个阶段消耗时间"},"state":"success","ready":true,"chart":{"width":"600","type":"echarts/custom"},"filter":"var option = {\n  tooltip: {\n    show: true\n  },\n  xAxis : [\n    {\n      type : 'category',\n      axisLabel : {\n        interval : 0\n      },\n      data : rs.map(function(item){\n        return item.type;\n      })\n    }\n  ],\n  yAxis : [\n    {\n      type : 'value'\n    }\n  ],\n  series : [\n    {\n      name : '消耗时间',\n\t  type : \"bar\",\n\t  data : rs.map(function(item){\n        return item.time;\n      })\n\t},\n    {\n      name : '间隔时间',\n\t  type : \"bar\",\n\t  data : rs.map(function(item){\n        return item.interval;\n      })\n\t}\n  ]\n};\n\nreturn option;"}}}